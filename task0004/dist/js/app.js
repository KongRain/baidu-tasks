console.log("util加载成功"),define("util",[],function(){function e(e,t,n){var t=t.replace(/^on/,"").toLowerCase();e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}function t(e,t,n){var t=t.replace(/^on/,"").toLowerCase();e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}function n(t,n,a,s){e(t,a,function(e){for(var a=e||window.event,l=i(e),r=l.nodeName.toLowerCase();r!=n&&l!=t;)l=l.parentNode,r=l.nodeName.toLowerCase();r==n&&s.call(l,a)})}function i(e){var t=(e||window.event,e.srcElement||e.target);return t}function a(e){var t=0;for(var n in e)e.hasOwnProperty(n)&&t++;return t}function s(e){return e.replace(/^\s*|\s*$/g,"")}function l(e,t){var n;if("string"==typeof t){var i=(t||"").match(/\S+/g)||[],a=e.className,l=1===e.nodeType&&(a?(" "+a+" ").replace(/[\t\r\n\f]/g," "):" ");if(l)for(var r=i.length,o=0;r>o;o++)l.indexOf(" "+i[o]+" ")<0&&(l+=i[o]+" ");n=s(l),a!=n&&(e.className=n)}}function r(e,t){var n=e.className;if(0!=n.length){for(var i=n.split(/\s+/),a=0,s=i.length;s>a;a++)i[a]==t&&i.splice(a,1);var l=i.join(" ");e.className=l}}function o(e,t){if(t&&e.className)for(var n=e.className.split(/\s+/),i=0,a=n.length;a>i;i++)if(t===n[i])return!0;return!1}function c(e){if(!e||"string"!=typeof e)return!1;var t,n=/\s+/;if(n.test(e))for(var i=e.split(" "),a=h(document,i[0]),s=0;s<a.length;s++){var l=h(a[s],i[1]);if(l.length){t=l[0];break}}else t=h(document,e)[0];return t}function d(e,t,n){if(!e||!t)return!1;for(var i=e.getElementsByTagName("*"),a=new Array,s=n?1:0,l=0;l<i.length;l++)if(i[l].hasAttribute(t)){var r=i[l];s?r.getAttribute(t)==n&&a.push(r):a.push(r)}return a}function h(e,t){if(!e||!t||"string"!=typeof t)return!1;var n,i,a=new Array;switch(t[0]){case"#":n=t.slice(1),i=e.getElementById(n),a.push(i);break;case".":n=t.slice(1),a=e.getElementsByClassName(n);break;case"[":if(-1==t.search(/=/g)){n=t.slice(1,-1),a=d(e,n);break}var s=/^\[(\w+)\s*=\s*('|")(\w+)('|")\]$/g,l=s.exec(t),r=l[1],o=l[3];a=d(e,r,o);break;default:a=e.getElementsByTagName(t)}return a}function u(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes}function f(){var e=window.innerWith||document.documentElement.clientWidth||document.body.clientWidth;return console.log("viewPortwidth:"+e),e}return c.on=function(t,n,i){var a=c(t);return e(a,n,i)},c.un=function(e,n,i){var a=c(e);return t(a,n,i)},c.click=function(e,t){var n=c(e);return addClickEvent(n,t)},c.enter=function(e,t){var n=c(e);return addEnterEvent(n,t)},c.delegate=function(e,t,i,a){var s=c(e);return n(s,t,i,a)},{addEvent:e,removeEvent:t,delegateEvent:n,getTarget:i,objLen:a,addClass:l,removeClass:r,hasClass:o,$:c,createDOMByStr:u,getViewWidth:f,appMaxWith:767}}),console.log("appEvent加载成功"),define("appEvent",["util"],function(e){function t(){var t=e.$(".currentview"),n=t.next;e.hasClass(n,"nextview")||e.addClass(n,"nextview"),e.removeClass(t,"currentview"),e.addClass(t,"preview"),e.removeClass(n,"nextview"),e.addClass(n,"currentview"),i()}function n(){var t=e.$(".currentview"),n=t.pre;e.hasClass(n,"preview")||e.addClass(n,"preview"),e.removeClass(t,"currentview"),e.addClass(t,"nextview"),e.removeClass(n,"preview"),e.addClass(n,"currentview"),i()}function i(){var t=e.$(".back"),n=e.$(".currentview");t.style.display=e.hasClass(n,"task-class")?"none":"block"}var a=document.getElementsByTagName("article");return a[0].pre=null,a[0].next=a[1],a[1].pre=a[0],a[1].next=a[2],a[2].pre=a[1],a[2].next=null,{nextIn:t,preIn:n}}),console.log("localStorage加载成功"),define("localStorage",[],function(){function e(e,t){localStorage.getItem("klass")?t():e()}function t(){var e=[{id:0,name:"默认分类",children:[0]}],t=[{id:0,name:"功能介绍",children:[0]}],n=[{id:0,name:"使用说明",date:"2015-07-22",finished:!0,detail:"此款任务管理器支持多级任务处理，可以添加、删除、编辑任务，可以为任务分类，记录任务生成时间等。\n\nps:默认分类与默认文件不能删除哦！"}];localStorage.setItem("klass",JSON.stringify(e)),localStorage.setItem("file",JSON.stringify(t)),localStorage.setItem("task",JSON.stringify(n))}function n(){if(!localStorage.getItem("klass"))return console.log("no klass in storage"),!1;var e=localStorage.getItem("klass"),t=JSON.parse(e);return console.log("allKlasses: "+t),t}function i(e,t){if(!localStorage.getItem(t))return console.log("no "+t+"in storage"),!1;for(var n,i=JSON.parse(localStorage.getItem(t)),a=0,s=i.length;s>a;a++)if(i[a].id===e){n=i[a];break}return console.log(""+t+e+": "+n),n}function a(e){var t=JSON.parse(localStorage.getItem(e)),n=t.length,i=t[n-1].id;return i}function s(e,t,n,i,s){var l=a(e)+1;if("klass"==e||"file"==e)var r={id:l,name:t,children:[]};else if("task"==e)var r={id:l,name:t,date:n,finished:i,detail:s};var o=JSON.parse(localStorage.getItem(e));return o.push(r),localStorage.setItem(e,JSON.stringify(o)),r}function l(e,t,n,i){for(var a=JSON.parse(localStorage.getItem(e)),s=null,l=0,r=a.length;r>l;l++)if(a[l].id===t){s=a[l];break}s[n]=i,localStorage.setItem(e,JSON.stringify(a))}function r(e,t){var n=s("file",t),a=i(e,"klass"),r=a.children;return r.push(n.id),l("klass",e,"children",r),n}function o(e,t,n,a,r){var o=s("task",t,n,a,r),c=i(e,"file"),d=c.children;return d.push(o.id),l("file",e,"children",d),o}function c(e,t){if("klass"===e)u(t);else{if("file"!==e)return;h(t)}}function d(e){for(var t=JSON.parse(localStorage.getItem("task")),n=null,i=0,a=t.length;a>i;i++)if(t[i].id===e){n=t[i],t.splice(i,1);break}localStorage.setItem("task",JSON.stringify(t))}function h(e){for(var t=JSON.parse(localStorage.getItem("file")),n=null,i=0,a=t.length;a>i;i++)if(t[i].id===e){n=t[i];var s=n.children,l=s.length;if(0!==l)for(var r=0;l>r;r++)d(s[r]);t.splice(i,1);break}localStorage.setItem("file",JSON.stringify(t))}function u(e){for(var t=JSON.parse(localStorage.getItem("klass")),n=null,i=0,a=t.length;a>i;i++)if(t[i].id===e){n=t[i];var s=n.children,l=s.length;if(0!==l)for(var r=0;l>r;r++)h(s[r]);t.splice(i,1);break}localStorage.setItem("klass",JSON.stringify(t))}return{initData:e,setDefault:t,getKlass:n,getItem:i,getFinalId:a,addItem:s,modifyItem:l,addFile:r,addTask:o,deleteItem:c}}),console.log("main加载成功"),define("main",["util","appEvent","localStorage"],function(e,t,n){function i(){this.klasses=[],this.sum=1,this.currentKlass=null,this.init()}return i.prototype={constructor:i,addKlass:function(e){this.klasses.push(e),e.setParent(this),e.show(),e.init(),this.setCurrentKlass(e)},removeKlass:function(t){var n=this.klasses,i=n.indexOf(t);-1!=i&&(n.splice(i,1),e.$(".class-list").removeChild(t.ui))},getKlass:function(e){for(var t=this.klasses,n=0,i=t.length;i>n;n++)if(t[n].name==e)return t[n]},getKlassById:function(e){for(var t=this.klasses,n=0,i=t.length;i>n;n++)if(t[n].id===e)return t[n]},getSum:function(){var e=0;return this.klasses.forEach(function(t){t.files.forEach(function(t){e+=t.tasks.length})}),e},setSum:function(){this.sum=this.getSum(),e.$(".task-class .sum").innerHTML=this.sum},setCurrentKlass:function(t){this.currentKlass=t;var n=e.$(".class-list").getElementsByClassName("active");Array.prototype.forEach.call(n,function(t){e.removeClass(t,"active")}),t.highLight()},init:function(){this.eventDelegate(),this.cilckDelete(),this.setSum()},eventDelegate:function(){var t=this;e.addEvent(e.$(".class-list"),"click",function(n){for(var i=e.getTarget(n),a=i.tagName.toLowerCase();"h3"!=a&&"h4"!=a;)i=i.parentNode,a=i.tagName.toLowerCase();if("h4"!=a){var s=i.lastChild.nodeValue;s=s.replace(/\s*\(\d+\)$/,"");var l=t.getKlass(s);t.setCurrentKlass(l),l.toggle()}})},cilckDelete:function(){var t=this;e.addEvent(e.$(".class-list"),"click",function(i){var a=i||window.event,s=e.getTarget(i);if(e.hasClass(s,"fa-close")&&"h3"==s.parentNode.nodeName.toLowerCase()){a.cancelBubble?a.cancelBubble=!0:a.stopPropagation();var l=confirm("确定删除此分类？");if(l){var r=s.parentNode.lastChild.nodeValue;r=r.replace(/\s*\(\d+\)$/,"");var o=t.getKlass(r);t.removeKlass(o);for(var c=o.id,d=n.getItem(c,"klass"),h=d.children,u=0,f=h.length;f>u;u++)n.deleteItem("file",h[u]);n.deleteItem("klass",c);var v=e.$(".sum").innerHTML,m=0;o.files.forEach(function(e){m+=e.tasks.length}),v-=m,e.$(".sum").innerHTML=v}}})}},{Main:i}}),console.log("klass加载成功"),define("klass",["util","appEvent","localStorage"],function(e,t,n){function i(e,t){this.id=t,this.name=e,this.files=[],this.ui=null,this.currentFile=null,this.parent=null}return i.prototype={constructor:i,show:function(){var t=e.$(".task-class .class-list"),n=this.createLi("folder");this.setUI(n);var i=n.getElementsByTagName("h3")[0],a=document.createTextNode(this.name+"("+this.files.length+")");i.appendChild(a),t.appendChild(n)},setUI:function(e){this.ui=e},setCurrentFile:function(t){this.currentFile=t,this.parent.setCurrentKlass(this);var n=e.$(".class-list").getElementsByClassName("active");Array.prototype.forEach.call(n,function(t){e.removeClass(t,"active")}),t.highLight()},setParent:function(e){this.parent=e},addFile:function(e){this.files.push(e);var t=e.createUI(),n=this.ui.getElementsByTagName("ul")[0];if(n)n.appendChild(t);else{var i=document.createElement("ul");i.appendChild(t),this.ui.appendChild(i)}this.setCurrentFile(e),this.updateLength(),e.init(),e.setParent(this)},updateLength:function(){var e=this.ui.getElementsByTagName("h3")[0];e.lastChild.nodeValue=this.name+"("+this.files.length+")"},removeFile:function(e){var t=this.files,n=t.indexOf(e);-1!=n&&(t.splice(n,1),this.ui.getElementsByTagName("ul")[0].removeChild(e.ui),this.updateLength())},toggle:function(){if(0!=this.files.length){var e=this.ui.getElementsByTagName("ul")[0];if(e)e.style.display="block"==e.style.display?"none":"block";else{var t=document.createElement("ul");this.ui.appendChild(t),this.files.forEach(function(e){t.appendChild(e.createUI())})}}},getFile:function(e){for(var t=this.files,n=0,i=t.length;i>n;n++)if(t[n].name==e)return t[n]},getFileById:function(e){for(var t=this.files,n=0,i=t.length;i>n;n++)if(t[n].id==e)return t[n]},highLight:function(){e.addClass(this.ui.getElementsByTagName("h3")[0],"active")},unHighLight:function(){e.removeClass(this.ui.getElementsByTagName("h3")[0],"active")},createLi:function(t){var n,t=t?t:"folder",i=document.createElement("li");n=document.createElement("folder"==t?"h3":"h4");var a=document.createElement("i");return a.className="fa fa-close",e.addClass(n,t),n.appendChild(a),i.appendChild(n),i},clickEventDelegate:function(){var n=this;e.addEvent(e.$(".class-list"),"click",function(i){for(var a=i||window.event,s=e.getTarget(a),l=s.tagName.toLowerCase();"h3"!=l&&"h4"!=l;)s=s.parentNode,l=s.tagName.toLowerCase();if("h3"!=l){a.cancelBubble?a.cancelBubble:a.stopPropagation();var r=s.lastChild.nodeValue;r=r.replace(/\s*\(\d+\)$/,"");var o=n.getFile(r);o&&(n.setCurrentFile(o),o.showTasks(),e.getViewWidth()<=e.appMaxWith&&t.nextIn())}})},enterEventDelegate:function(){e.addEvent(this.ui,"mouseover",this.showIcon)},leaveEventDelegate:function(){e.addEvent(this.ui,"mouseout",this.hintIcon)},showIcon:function(){var e=this.getElementsByClassName("fa-close")[0];e.style.display="inline-block"},hintIcon:function(){var e=this.getElementsByClassName("fa-close")[0];e.style.display="none"},removeMouseEvent:function(){e.removeEvent(this.ui,"mouseover",this.showIcon),e.removeEvent(this.ui,"mouseout",this.hintIcon)},cilckDelete:function(){var t=this;e.addEvent(this.ui,"click",function(i){var a=i||window.event,s=e.getTarget(i);if(e.hasClass(s,"fa-close")&&"h4"==s.parentNode.nodeName.toLowerCase()){a.cancelBubble?a.cancelBubble=!0:a.stopPropagation();var l=confirm("确定删除此分类？");if(l){var r=s.parentNode.lastChild.nodeValue;r=r.replace(/\s*\(\d+\)$/,"");var o=t.getFile(r),c=o.id;t.removeFile(o);var d=n.getItem(t.id,"klass"),h=d.children,u=h.indexOf(c);h.splice(u,1),n.modifyItem("klass",t.id,"children",h),n.deleteItem("file",c);var f=parseInt(e.$(".sum").innerHTML);f-=o.tasks.length,e.$(".sum").innerHTML=f}}})},init:function(){this.clickEventDelegate(),this.enterEventDelegate(),this.leaveEventDelegate(),this.cilckDelete()}},{Klass:i}}),console.log("list加载成功"),define("list",["util"],function(e){function t(){this.allList=e.$(".all"),this.doneList=e.$(".finish"),this.undoneList=e.$(".unFinish"),this.dates=[],this.switchHandler()}return t.prototype={constructor:t,showTask:function(t){var n,i=t.date;this.dates.indexOf(i)<0?(this.dates.push(i),n=this.createDateItem(i)):n=this.searchDateItem(i);var a=document.createElement("div");a.innerHTML=t.name,e.addClass(a,"item"),t.finished&&e.addClass(a,"done"),n.appendChild(a),t.setUI(a),t.init()},createDateItem:function(t){var n=document.createElement("div"),i=document.createElement("div");return i.innerHTML=t,e.addClass(n,"dateItem"),e.addClass(i,"date"),n.appendChild(i),this.allList.appendChild(n),n},searchDateItem:function(e){if(-1!=this.dates.indexOf(e)){for(var t,n,i=this.allList,a=i.getElementsByClassName("date"),s=0,l=a.length;l>s;s++)if(a[s].innerHTML==e){t=a[s],n=a[s].parentNode;break}return n}},clear:function(){this.allList.innerHTML="",this.doneList.innerHTML="",this.undoneList.innerHTML=""},updateBoth:function(){this.updateDone(),this.updateUndone()},updateDone:function(){this.doneList.innerHTML=this.allList.innerHTML;for(var t=this.doneList.getElementsByClassName("item"),n=t.length,i=n-1;i>=0;i--){var a=t[i];if(a.classList.contains("done"))e.removeClass(a,"done");else{var s=a.parentNode;s.removeChild(a),1==s.children.length&&this.doneList.removeChild(s)}}},updateUndone:function(){this.undoneList.innerHTML=this.allList.innerHTML;for(var e=this.undoneList.getElementsByClassName("item"),t=e.length,n=t-1;n>=0;n--){var i=e[n];if(i.classList.contains("done")){var a=i.parentNode;a.removeChild(i),1==a.children.length&&this.undoneList.removeChild(a)}}},switchTo:function(t){var t=t||"all",n=e.$(".task-list .b-all"),i=e.$(".task-list .b-undone"),a=e.$(".task-list .b-done");"all"==t?(e.addClass(n,"active"),e.removeClass(a,"active"),e.removeClass(i,"active"),this.allList.style.display="block",this.doneList.style.display=this.undoneList.style.display="none"):"undone"==t?(e.addClass(i,"active"),e.removeClass(n,"active"),e.removeClass(a,"active"),this.undoneList.style.display="block",this.allList.style.display=this.doneList.style.display="none"):(e.addClass(a,"active"),e.removeClass(i,"active"),e.removeClass(n,"active"),this.doneList.style.display="block",this.allList.style.display=this.undoneList.style.display="none")},deleteTask:function(e){var t=e.ui,n=t.parentNode;if(n.removeChild(t),1==n.children.length){n.parentNode.removeChild(n);var i=this.dates.indexOf(e.date);this.dates.splice(i,1)}},switchHandler:function(){var t=this;e.addEvent(e.$(".task-list ul"),"click",function(n){var i=n||window.event,a=e.getTarget(i),s=a.className;switch(s){case"b-all":t.switchTo("all");break;case"b-undone":t.switchTo("undone");break;case"b-done":t.switchTo("done")}})}},{List:t}}),console.log("file加载成功"),define("file",["util","list","appEvent"],function(e,t,n){function i(e,n){this.id=n,this.name=e,this.tasks=[],this.ui=null,this.list=new t.List,this.currentTask=null,this.parent=null}return i.prototype={constructor:i,createUI:function(){var e=this.createLi("file");this.setUI(e);var t=e.getElementsByTagName("h4")[0],n=document.createTextNode(this.name+"("+this.tasks.length+")");return t.appendChild(n),e},setUI:function(e){this.ui=e},setCurrentTask:function(e){this.currentFile=e},setParent:function(e){this.parent=e},addTask:function(e){this.tasks.push(e),this.list.showTask(e),this.list.updateBoth(),this.otherListHandler(),this.currentTask=e,this.updateLength(),e.setParent(this)},removeTask:function(e){var t=this.tasks,n=t.indexOf(e);-1!=n&&(t.splice(n+1,1),this.list.deleteTask(e))},updateLength:function(){var e=this.ui.getElementsByTagName("h4")[0];e.lastChild.nodeValue=this.name+"("+this.tasks.length+")"},getTask:function(e){for(var t=this.tasks,n=0,i=t.length;i>n;n++)if(t[n].name==e)return t[n]},getTaskById:function(e){for(var t=this.tasks,n=0,i=t.length;i>n;n++)if(t[n].id==e)return t[n]},showTasks:function(){var e=this;this.list.clear(),this.list.dates=[],this.tasks.forEach(function(t){e.list.showTask(t)}),this.list.switchTo("all"),this.list.updateBoth(),this.otherListHandler()},otherListHandler:function(){for(var t=this.list.doneList.getElementsByClassName("item"),i=this.list.undoneList.getElementsByClassName("item"),a=0,s=t.length;s>a;a++){var l=this;e.addEvent(t[a],"click",function(){var t=this.innerHTML,i=l.getTask(t);i.showDetail(),e.getViewWidth()<=e.appMaxWith&&n.nextIn()})}for(var r=0,o=i.length;o>r;r++){var l=this;e.addEvent(i[r],"click",function(){var t=this.innerHTML,i=l.getTask(t);i.showDetail(),e.getViewWidth()<=e.appMaxWith&&n.nextIn()})}},highLight:function(){e.addClass(this.ui.getElementsByTagName("h4")[0],"active")},unHighLight:function(){e.removeClass(this.ui.getElementsByTagName("h4")[0],"active")},createLi:function(t){var n,t=t?t:"folder",i=document.createElement("li");n=document.createElement("folder"==t?"h3":"h4");var a=document.createElement("i");return a.className="fa fa-close",e.addClass(n,t),n.appendChild(a),i.appendChild(n),i},enterEventDelegate:function(){e.addEvent(this.ui,"mouseover",this.showIcon)},leaveEventDelegate:function(){e.addEvent(this.ui,"mouseout",this.hintIcon)},showIcon:function(e){var t=e||window.event;t.cancelBubble?t.cancelBubble=!0:t.stopPropagation();var n=this.getElementsByClassName("fa-close")[0];n.style.display="inline-block"},hintIcon:function(e){var t=e||window.event;t.cancelBubble?t.cancelBubble=!0:t.stopPropagation();var n=this.getElementsByClassName("fa-close")[0];n.style.display="none"},removeMouseEvent:function(){e.removeEvent(this.ui,"mouseover",this.showIcon),e.removeEvent(this.ui,"mouseout",this.hintIcon)},init:function(){this.enterEventDelegate(),this.leaveEventDelegate()}},{File:i}}),console.log("task加载成功"),define("task",["util","appEvent"],function(e,t){function n(e,t,n,i,a){this.id=a,this.name=e,this.date=t,this.finished=n,this.detail=i,this.ui=null,this.parent=null}return n.prototype={constructor:n,setId:function(e){"number"==typeof e&&(this.id=e)},setName:function(e){"string"==typeof e&&(this.name=e)},setDate:function(e){"string"==typeof e&&(this.date=e)},setFinished:function(e){"boolean"==typeof e&&(this.finished=e)},setDetail:function(e){"string"==typeof e&&(this.detail=e)},setUI:function(e){this.ui=e},setParent:function(e){this.parent=e},showDetail:function(){e.$(".task-name").innerHTML=this.name,e.$(".task-date").innerHTML=this.date,e.$(".detail-body").innerHTML=this.detail,e.$(".edit-submit").style.display="none",e.$(".detail-head").style.display=this.finished?"none":"block",this.parent.currentTask=this},edit:function(){var t='<input class="input-name" type="text" ';t+=this.name?"value="+this.name:'placeholder="请输入任务名称"',t+=" />",e.$(".task-name").innerHTML=t;var n='<input class="input-date" type=';n+=this.date?'"text" value='+this.date:'"date"',n+=" />",e.$(".task-date").innerHTML=n;var i='<textarea class="input-detail" ';i+=this.detail?">"+this.detail+"</textarea>":'palceholder="请输入任务内容"></textarea>',e.$(".detail-body").innerHTML=i,e.$(".edit-submit").style.display="block"},submitEdit:function(){var t=e.$(".input-name").value,n=e.$(".input-date").value,i=e.$(".input-detail").value;return""==t?(alert("请输入任务名称"),!1):""==n?(alert("请输入日期"),!1):(this.name=t,this.date=n,this.detail=i,!0)},finishTask:function(){this.finished=!0,e.addClass(this.ui,"done")},clickHandler:function(){var n=this;e.addEvent(this.ui,"click",function(){n.showDetail(),e.getViewWidth()<=e.appMaxWith&&t.nextIn()})},init:function(){this.clickHandler()}},{Task:n}}),console.log("index加载成功"),require(["util","main","klass","file","task","appEvent","localStorage"],function(e,t,n,i,a,s,l){function r(){var e=o,n=c;l.initData(e,n),d(),t.setSum()}function o(){l.setDefault(),c()}function c(){for(var e=l.getKlass(),s=0,r=e.length;r>s;s++){var o=e[s],c=o.name,d=o.id,h=new n.Klass(c,d);t.addKlass(h);for(var u=o.children,f=0,v=u.length;v>f;f++){var m=l.getItem(u[f],"file"),g=new i.File(m.name,m.id);h.addFile(g);for(var p=m.children,k=0,y=p.length;y>k;k++){var E=l.getItem(p[k],"task"),C=new a.Task(E.name,E.date,E.finished,E.detail,E.id);g.addTask(C),C.showDetail()}}}}function d(){var e=t.getKlassById(0),n=e.getFileById(0),i=n.getTaskById(0);t.setCurrentKlass(e),e.setCurrentFile(n),n.showTasks(),i.showDetail(),e.removeMouseEvent(),n.removeMouseEvent()}var t=new t.Main;r(),e.addEvent(e.$(".task-class .addition"),"click",function(){e.$(".prompt").style.display="block"}),e.addEvent(e.$(".prompt .sure"),"click",function(){var a=e.$("#select-class").value,s=e.$("#class-name").value;if(""==s&&alert("请填写任务名称"),"parent"==a){var r=l.addItem("klass",s),o=new n.Klass(s,r.id);t.addKlass(o)}else{var c=l.addFile(t.currentKlass.id,s),d=new i.File(s,c.id);t.currentKlass.addFile(d),d.showTasks()}e.$(".prompt").style.display="none",e.$("#class-name").value="",e.$("#select-class").value="parent"}),e.addEvent(e.$(".prompt .cancel"),"click",function(){e.$(".prompt").style.display="none",e.$("#class-name").value="",e.$("#select-class").value="parent"}),e.addEvent(e.$(".task-list .addition"),"click",function(){var n=t.currentKlass.currentFile;if(!n)return void alert("请先创建子分类");var i=new a.Task("","",!0,"");e.$(".detail-head").style.display="none",i.edit(),e.getViewWidth()<=e.appMaxWith&&s.nextIn()}),e.addEvent(e.$(".edit-submit .save"),"click",function(){var n=t.currentKlass.currentFile,i=n.currentTask;if("block"==e.$(".detail-head").style.display)n.list.deleteTask(i),i.submitEdit(),n.list.showTask(i),l.modifyItem("task",i.id,"name",i.name),l.modifyItem("task",i.id,"date",i.date),l.modifyItem("task",i.id,"detail",i.detail),i.showDetail();else{var s=new a.Task("","",!1,""),r=s.submitEdit();if(!r)return!1;var o=l.addTask(n.id,s.name,s.date,s.finished,s.detail);s.setId(o.id),n.addTask(s),s.showDetail(),t.setSum()}}),e.addEvent(e.$(".edit-submit .cancel"),"click",function(){var e=t.currentKlass.currentFile,n=e.currentTask;if(n)n.showDetail();else{var i=new i.Task("","",!0,"");i.showDetail()}}),e.addEvent(e.$(".detail-head"),"click",function(n){var i=e.getTarget(n),a=i.className,s=t.currentKlass.currentFile,r=s.currentTask;switch(a){case"ok fa fa-check-square-o":l.modifyItem("task",r.id,"finished",!0),r.finishTask(),s.list.updateBoth(),s.otherListHandler(),this.style.display="none";break;case"edit fa fa-pencil-square-o":r.edit()}}),e.addEvent(e.$(".back"),"click",function(){s.preIn()})}),define("index",["util","main","klass","file","task","appEvent","localStorage"],function(){});